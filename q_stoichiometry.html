<html>
<link rel="preconnect" href="https://fdn.fontcdn.ir">
<link rel="preconnect" href="https://v1.fontapi.ir">
<link href="https://v1.fontapi.ir/css/Vazir" rel="stylesheet">

<head>

	<link rel="stylesheet" href="reference-osu.css">
	<link rel="stylesheet" href="styles.css">
	<link rel="stylesheet" href="switch.css">
	<script src="https://cdn.jsdelivr.net/gh/nastyox/Rando.js@master/code/plain-javascript/2.0.0/rando-min.js"></script>
	<script src='https://cdn.jsdelivr.net/npm/bignumber.js@9.1.2/bignumber.min.js'></script>



	<script>
		// const materials = ["nacl", "feno32", "brcl", "ammonia", "methanole"];
		const materials = ["methanol"];
		const units_mass = ["mol", "gram"]
		const units_vol = ["lit", "mlit"]
		const units_all = units_mass.concat(units_vol);

		const sm = [0.9, 0.8, 0.75, 0.7, 0.6, 0.5, 0.25, 0.2, 0.125]

		const material_props = {
			methanol: {
				name: "متانول ", type: "fuel", mw: "32",
				mps: ["2", "3", "4", "2"],
				formula: "(CH₃OH)" // Fe(NO<sub>3</sub>)<sub>2</sub>
			}
		};

		const unit_props = {
			mol: { name: "مول " },
			gram: { name: "گرم " },
			lit: { name: "لیتر " },
			mlit: { name: "میلی‌لیتر " },
		};

		addEventListener("keypress", logKey);
		function logKey(e) {
			if (e.code == "KeyX") {
				GenerateOutput();
			} else if (e.code == "KeyZ") {
				Answer();
			}
		};


		/* const material_props = {
			nacl: {
				type: "salt",
				compounds: ["یون سدیم", "یون کلر"], mps: ["1", "1"]
			},
			feno32: {
				type: "salt",
				compounds: ["یون آهن", "یون کلر"], mps: ["1", "1"]
			}
		}; */

		function SelectMat() {
			return materials[Math.floor(Math.random() * materials.length)];
		}

		function GenerateFuel(mat) {
			let type = Math.floor(Math.random() * 2); // 0: Ask Oxygen  ,  1: Ask CO2 or H2O
			let massunit1 = units_mass[Math.floor(Math.random() * units_mass.length)];
			let mass1; switch (Math.floor(Math.random() * 2)) {
				case 0: // Downscale the Molar mass
					switch (massunit1) {
						case "gram": mass1 = material_props[`${mat}`].mw * material_props[`${mat}`].mps[0] * sm[Math.floor(Math.random() * sm.length)];
							console.log("downscale, gram"); break;
						case "mol": mass1 = BigNumber(material_props[`${mat}`].mw * material_props[`${mat}`].mps[0] * sm[Math.floor(Math.random() * sm.length)]).div(BigNumber(10));
							console.log("downscale, mol"); break;
					} break;
				case 1:  // Upscale the Molar mass 
					switch (massunit1) {
						case "gram": mass1 = material_props[`${mat}`].mw * material_props[`${mat}`].mps[0] * (Math.floor(Math.random() * 9) + 1);
							console.log("upscale, gram"); break;
						case "mol": mass1 = BigNumber(material_props[`${mat}`].mw * material_props[`${mat}`].mps[0] * (Math.floor(Math.random() * 9) + 1)).div(BigNumber(Math.pow(10,Math.floor(-1 * Math.random() * 3))));
							console.log("upscale, gram"); break;
					} break;
			}
			let massunit2 = units_all[Math.floor(Math.random() * units_all.length)];
			let mat2;

			let text_tp;
			let v_stp;

			if (units_vol.includes(massunit1) || units_vol.includes(massunit2)) {
				const s_stp = document.querySelector("#c_stp");
				if (s_stp.checked) {
					tp = -1;
					text_tp = "در شرایط STP، ";
				} else {

				}

			} else {
				text_tp = "";
			}

			switch (type) {
				default:
					return text_tp + "برای سوختن کامل " + mass1 + " " + unit_props[`${massunit1}`].name + material_props[`${mat}`].name
						+ material_props[`${mat}`].formula + "،" + " به چند " + unit_props[`${massunit2}`].name + "گاز اکسیژن نیاز داریم؟";
					break;
			}
		}

		function GenerateOutput() {
			let text_tp, text_data, text_req, text_end;

			let tp;
			let val1, unit1, mat1;
			let val2, unit2, mat2;

			let inft;
			let material = SelectMat();
			switch (material_props[`${material}`].type) {
				case "fuel": inft = GenerateFuel(material); break;
			}
			document.getElementById("r1").innerHTML = `${inft}`;
		}
	</script>



</head>

<body>
	<div class="header">
		<a href="index.html" class="logo">سوال ساز رندوم</a>
		<div class="header-right">
			<a class="menu" href="index.html">صفحۀ اصلی</a>
		</div>
	</div>
	<br /><br />
	<div class="columnview">
		<div class="column">
			<div class="section">
				<h2 class="section-title">تنظیمات</h2>
			</div>

			<div class="settings-groups">
				<div class="section-content">
					<div class="section-entry">
						<div><label class="switch">
								<input type="checkbox" id="c_stp" checked="">
								<div class="slider">
									<div class="circle">
										<svg class="cross" xml:space="preserve"
											style="enable-background:new 0 0 512 512" viewBox="0 0 365.696 365.696"
											y="0" x="0" height="6" width="6" xmlns:xlink="http://www.w3.org/1999/xlink"
											version="1.1" xmlns="http://www.w3.org/2000/svg">
											<g>
												<path data-original="#000000" fill="currentColor"
													d="M243.188 182.86 356.32 69.726c12.5-12.5 12.5-32.766 0-45.247L341.238 9.398c-12.504-12.503-32.77-12.503-45.25 0L182.86 122.528 69.727 9.374c-12.5-12.5-32.766-12.5-45.247 0L9.375 24.457c-12.5 12.504-12.5 32.77 0 45.25l113.152 113.152L9.398 295.99c-12.503 12.503-12.503 32.769 0 45.25L24.48 356.32c12.5 12.5 32.766 12.5 45.247 0l113.132-113.132L295.99 356.32c12.503 12.5 32.769 12.5 45.25 0l15.081-15.082c12.5-12.504 12.5-32.77 0-45.25zm0 0">
												</path>
											</g>
										</svg>
										<svg class="checkmark" xml:space="preserve"
											style="enable-background:new 0 0 512 512" viewBox="0 0 24 24" y="0" x="0"
											height="10" width="10" xmlns:xlink="http://www.w3.org/1999/xlink"
											version="1.1" xmlns="http://www.w3.org/2000/svg">
											<g>
												<path class="" data-original="#000000" fill="currentColor"
													d="M9.707 19.121a.997.997 0 0 1-1.414 0l-5.646-5.647a1.5 1.5 0 0 1 0-2.121l.707-.707a1.5 1.5 0 0 1 2.121 0L9 14.171l9.525-9.525a1.5 1.5 0 0 1 2.121 0l.707.707a1.5 1.5 0 0 1 0 2.121z">
												</path>
											</g>
										</svg>
									</div>
								</div>
							</label></div>
						<span dir="rtl" class="settings-entry-title">شرایط STP</span>

					</div>
				</div>
			</div>
		</div>

		<div class="column">
			<div class="section">
				<h2 class="section-title">سوال</h2>
			</div>

			<div class="section-content">
				<div class="section-entry">
					<p class="result2" dir="rtl" id="r1">
						<span id="r1p1">‌</span>
					</p>
				</div>
			</div>
		</div>

	</div>
	<div class="buttonsline">
		<p dir="rtl"><button class="button_gen" role="button" onclick="GenerateOutput()">بساز!</button>
	</div>
	<div class="result">
		<p dir="rtl">
			<span id="r1p1"></span>
			<math display="inline">
				<mrow>
					<mi id="r1p2"></mi>
				</mrow>
			</math>
			<span id="r1p3"></span>
			<span id="r1p4"></span><br />

			<span id="r2p1"></span>
			<span id="r2p2"></span>
			<span id="r2p3"></span>
			<span id="r2p4"></span>
		</p>
		<div>
</body>

</html>